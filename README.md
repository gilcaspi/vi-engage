# Increasing WellCo Member Retention with Vi Engage
## By *Vi Labs* 
**Version:** v1 | **Date:** Nov 11, 2025 | **Authors**: Vi Labs Team (Or Yair, Allon Hammer, Gil Caspi)

## 1. Executive Summary
WellCo experienced increased members churn rates recently and seek Vi Labs assistance in reducing it. 
Vi Labs seamlessly integrated with WellCo's data systems and developed an AI-driven outreach strategy to optimize retention efforts.
**Vi Engage increased WellCo's expected member retention uplift from 1.32% to 3.94% - using the same outreach budget.**

Short podcast about how Vi Engage helped WellCo (Hebrew):  
[üéß Listen to the podcast episode - generated by NotebookLM](https://drive.google.com/file/d/1LIi9_6jaJAByuxyoUmUOZ8saY9iQA-kB/view?usp=sharing)

## 2. Deliverables Summary
### 2.1 Public Repository
[üîó GitHub Repository: gilcaspi/vi-engage](https://github.com/gilcaspi/vi-engage)

### 2.2 Documentation
**README file with setup instructions and approach description:**  
[üìÑ View README.md](https://github.com/gilcaspi/vi-engage/blob/master/README.md)

### 2.3 Executive Presentation
**Tailored for non-technical stakeholders**  
- [üìé PDF (attached version)](./artifacts/presentations/Increasing%20WellCo%20Member%20Retention%20with%20Vi%20Engage.pdf)  
- [üåê View latest online version](https://github.com/gilcaspi/vi-engage/blob/master/artifacts/presentations/Increasing%20WellCo%20Member%20Retention%20with%20Vi%20Engage.pdf)

### 2.4 Outreach Recommendations
**CSV file with a sorted list of top-N members for outreach**  
- [üìé CSV (attached version)](./artifacts/predictions/latest_outreach_suggestion.csv)  
- [üåê View latest online version](https://github.com/gilcaspi/vi-engage/blob/master/artifacts/predictions/latest_outreach_suggestion.csv)

## 3. Getting Started
### 3.1 Install Python 3.11
https://www.python.org/downloads/release/python-31114/

### 3.2 Create Virtual Environment (Recommended)
```bash
    python3.11 -m venv venv
    source venv/bin/activate
```

### 3.3 Install Required Packages
```bash
    pip install -r requirements.txt
```

### 3.4 Run the analysis pipeline: 
1. **Optional** - Run features generation: 
```bash
    python runners/run_features_generation.py
```    

2. **Optional** - Data exploration notebook: 
```bash
    jupyter lab data_exploration.ipynb
```

3. Train and evaluate models: 
```bash
    python runners/run_training_and_evaluation.py
```

4. Report notebook with train and evaluation results: 
```bash
    jupyter lab final_report_notebook.ipynb
```

5.Artifacts and results are saved in the `artifacts/` folder.
    5.1. Table with top-N members for outreach (ranked and sorted): `artifacts/predictions/latest_outreach_suggestion.csv`

## 4. Objective & Problem Definition
WellCo seeks to reduce member churn through data-driven, personalized online interventions.  
The main objective is:
- **Maximize Retention Uplift:** Identify members most likely to benefit from targeted interventions and maximize overall retention impact.

Output should include a ranked list of members for outreach, along with prioritization scores and rank. 

## 5. Data Overview 
1. WellCo datasets: 
   1. churn labels:
      1. member_id 
      2. signup_date
      3. churn 
      4. outreach

   2. claims (icd10 codes): 
      1. member_id 
      2. icd_code 
      3. diagnosis_date

2. Vi Labs datasets: 
   1. web visits:
      1. member_id 
      2. url 
      3. title 
      4. description 
      5. timestamp

## 6. Feature Engineering

### 6.1 Claims-Based Features
Derived from ICD-10 diagnosis codes:
- **has_diabetes (E11.9)** ‚Äì binary flag  
- **has_hypertension (I10)** ‚Äì binary flag  
- **has_dietary_counseling (Z71.3)** ‚Äì binary flag  
- **in_cohort** ‚Äì flag for members with any of the above

### 6.2 App Usage Features
Aggregated from the mobile app activity logs:
- `total_app_sessions` ‚Äì total sessions per member  
- `unique_app_active_days` ‚Äì distinct active days  
- `average_sessions_per_day` ‚Äì mean engagement intensity  
- `std_sessions_per_day` ‚Äì engagement variability  
- `max_sessions_per_day` ‚Äì peak daily activity  
- `app_usage_duration_days` ‚Äì active period (first‚Äìlast session)  
- `days_from_last_app_use` ‚Äì inactivity gap prior to churn observation

### 6.3 Web Visit Features
Extracted from web interaction data:
- `total_web_visits` ‚Äì overall visits  
- `unique_urls` ‚Äì number of unique visited URLs  
- `total_wellco_visits` ‚Äì visits to WellCo-related domains  
- `wellco_visits_ratio` ‚Äì share of WellCo visits among total  
- `unique_wellco_active_days` ‚Äì active days on WellCo web content  
- `average_wellco_visits_per_day` ‚Äì normalized engagement metric

Semantic web pages categories features (added in feature version v2): 
- Generate 10 clusters using K-Means on TF-IDF embeddings of page content (domain + title + description).
- For each cluster, create features:  
  - Category visit counts ‚Äì total visits in category (cluster)
  - Visit ratios ‚Äì share of visits in category with respect to total visits
  - Binary flags ‚Äì whether member visited category at least once
  - Category diversity (entropy) - diversity of visited categories
  - Time-based metrics - 
    - Days since last visit in category 
    - Number of active days in category
    - Average visits per active day in category
  
## 7. Modelling Framework

### 7.1 Baseline Churn Model
A **Logistic Regression** model (with standardized features and class balancing) was trained to predict churn probability.  

### 7.2 Uplift Modeling
To estimate **incremental impact** of outreach (the ‚Äútreatment‚Äù), we implemented uplift modeling using the *Two-Model* approach:

- **Treatment model:** predicts churn probability for outreached members  
- **Control model:** predicts churn probability for non-outreached members  
- **Uplift score:**  

  $$
  \text{uplift}(\mathbf{x}) = \mathbb{E}[\text{churn} \mid \text{outreach}=0, \mathbf{X}=\mathbf{x}] - \mathbb{E}[\text{churn} \mid \text{outreach}=1, \mathbf{X}=\mathbf{x}]
  $$

  Higher scores indicate members **less likely to churn if outreached**. 

### 7.3 Matching Procedure
Since the dataset is observational, we used **propensity score matching (PSM)** to simulate a randomized design (randomized control trial).


## 8. Algorithm Flow 
### 8.1 Load and join datasets
### 8.2 Train - Test split 
Split data into train (80%) and test (20%) sets, stratified by churn and outreach labels.
### 8.3 Balance treatment and control groups 
Use propensity-score matching to balance outreach and non-outreach groups.
### 8.4 Feature generation
Explained in Section 5.
### 8.5 Model training
- Train baseline churn model: $$\text {churn risk} = \mathbb{P}[\text{churn = 1} \mid \mathbf{X}=\mathbf{x}]$$ using Logistic Regression.
- Train uplift models (two models approach - treatment and control) to estimate retention gain from outreach (both XGBoost models): 
  - Treatment model: $$\mathbb{P}[\text{churn = 1} \mid \text{outreach = 1}, \mathbf{X}=\mathbf{x}]$$
  - Control model: $$\mathbb{P}[\text{churn = 1} \mid \text{outreach = 0}, \mathbf{X}=\mathbf{x}]$$

### 8.6 Members ranking and scoring 
- Compute uplift score:
  - $$\text{uplift}(\mathbf{x}) = \mathbb{P}[\text{churn = 1} \mid \text{outreach = 0}, \mathbf{X}=\mathbf{x}] - \mathbb{P}[\text{churn = 1} \mid \text{outreach = 1}, \mathbf{X}=\mathbf{x}]$$
- Rank members by uplift score (highest to lowest).
- Select top-N members for outreach based on budget constraints.

## 9. Evaluation & Results
- Cumulative gain in retention uplift from 1.32% (current outreach policy) to 3.94% (Vi Engage uplift model) using the same outreach budget.

## 10. Cost - Value Optimization
- Given cost and lifetime value per member, optimize N to maximize ROI.

## 11. Next Steps 
### 11.1 **Improve Scoring & Ranking Method**
   - Integration of churn risk model & uplift model for improved prioritization (at risk & outreach effective)

### 11.2 **Model Optimization**  
   - Evaluate alternative models  
   - Tune hyperparameters  
   - Test alternative uplift modeling approaches  

### 11.3 **Feature Enrichment**  
   - Improve web page classification using LLMs  

### 11.4 **Code Refactoring**  
   - Prepare Vi Engage for seamless integration with future clients  

### 11.5 **Business Alignment**  
   - Optimize expected ROI through a personalized outreach method for each member  
   - Requires access to WellCo‚Äôs outreach cost structure and average member value
   - Deeper feature importance analysis to extract actionable business insights (SHAP, LIME, etc.)
